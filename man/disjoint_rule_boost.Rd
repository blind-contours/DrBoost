% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DrBoost.R
\name{disjoint_rule_boost}
\alias{disjoint_rule_boost}
\title{Disjoint Rule Boosting (Exhaustive up to 3D) with binning & validation (Parallel Search)}
\usage{
disjoint_rule_boost(
  X_train,
  Y_train,
  X_val,
  Y_val,
  outcome_type = c("continuous", "binary"),
  feature_types = NULL,
  num_thresholds = 50,
  max_iterations = 20,
  min_obs_pct = 0.05,
  patience = 3
)
}
\arguments{
\item{X_train}{(n x p) numeric matrix of training features}

\item{Y_train}{numeric vector of length n, either continuous or 0/1 for binary classification}

\item{X_val}{(m x p) numeric matrix of validation features}

\item{Y_val}{numeric vector of length m}

\item{outcome_type}{Either \code{"continuous"} or \code{"binary"}.}

\item{feature_types}{character vector (length p) e.g. c("binary", "continuous", "ordinal").}

\item{num_thresholds}{integer, e.g. 50. Number of threshold cutpoints per feature (where applicable).}

\item{max_iterations}{maximum boosting iterations}

\item{min_obs_pct}{minimum fraction coverage for a region to be valid}

\item{patience}{integer, number of consecutive iterations allowed without improvement in validation error}
}
\value{
A list with:
\item{regions}{the final chosen bounding boxes (disjoint) in the best model}
\item{coeffs}{the numeric coefficient for each region}
\item{fitted_train}{final predictions on training data (raw scale if continuous, logit scale if binary)}
\item{fitted_val}{final predictions on validation data (same scale as fitted_train)}
\item{train_mse}{final MSE on training (on probability scale if binary)}
\item{val_mse}{final MSE on validation (on probability scale if binary)}
\item{validation_errors}{history of validation MSE across iterations}
\item{iter}{number of iterations actually performed}
}
\description{
Creates thresholds for each feature (binary/ordinal/continuous),
enumerates 1D/2D/3D bounding boxes in parallel (via OpenMP) that are disjoint
from old ones, picks the best region, updates a piecewise-constant model.
Early stopping is based on validation MSE with a patience parameter.
}
\details{
\itemize{
\item We call \code{\link{build_thresholds_list}} to produce a matrix of cutpoints (\code{thresholds_list}).
\item Each iteration calls \code{find_best_region_cpp_3way_omp} for a parallel
exhaustive search of 1D, 2D, 3D bounding boxes, skipping overlap with previously
chosen boxes.
\item The region with largest \(\lvert \text{mean residual}\rvert \,\sqrt{\text{coverage}}\) is chosen.
\item If \code{outcome_type="binary"}, \code{fitted_train} and \code{fitted_val} store
the logit-scale predictions, the residual is \code{Y - plogis(fitted)}, and we measure
MSE in the probability space: \(\frac{1}{n}\sum (Y_i - \mathrm{plogis}(fitted_i))^2\).
\item If \code{outcome_type="continuous"}, we do ordinary residual = \code{Y - fitted},
and measure MSE on the raw scale.
}
}
